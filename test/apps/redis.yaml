apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
    name: redis
    namespace: argocd
    # Finalizer that ensures that project is not deleted until it is not referenced by any application
    #  finalizers:
    #    - resources-finalizer.argocd.argoproj.io
#    annotations:
#    argocd.argoproj.io/refresh: hard
#        argocd.argoproj.io/sync-options: Validate=false
spec:
    project: default
    syncPolicy:
        automated:
            prune: true
            selfHeal: true
        syncOptions:
            - CreateNamespace=true
            #            - Validate=false
        retry:
            limit: 2
            backoff:
                duration: 2s
                factor: 2
                maxDuration: 1m
    source:
        chart: redis
        repoURL: https://charts.bitnami.com/bitnami
        targetRevision: 17.3.5
        helm:
            releaseName: redis
            #valueFiles: null
            #         - https://raw.githubusercontent.com/ifeneg/sops/main/app/redis.yaml
            #        - secrets+gpg-import-kubernetes://argocd/helm-secrets-private-keys#key.asc?https://raw.githubusercontent.com/ifeneg/sops/main/app/redis-enc.yaml
            #        - secrets+gpg-import:///helm-secrets-private-keys#key.asc?git+https://github.com/ifeneg/sops@app/redis-ha/secrets.yaml?ref=main"
            values: |
                global:
                    redis:
                        password: ENC[AES256_GCM,data:gNb96DrnV98=,iv:YBKEiwNbIfMyZog9Yo4eExzat3EIhpmbIHyh/oLqIxE=,tag:5VlpK9gQSDn3ToAPNZvR+w==,type:int]
                architecture: standalone
                master:
                    kind: Deployment
                    persistence:
                        enabled: false
    destination:
        server: https://kubernetes.default.svc
        namespace: redis
sops:
    kms: []
    gcp_kms: []
    azure_kv: []
    hc_vault: []
    age: []
    lastmodified: "2022-10-18T07:21:03Z"
    mac: ENC[AES256_GCM,data:IUx3sREEWUavXiMZnMEXhMpbgwjj2Qy45u64l24bhFNXTKbkvWCQUw5yp2xq26Q5Ey6xa2UWdaPcZ5tQ1d8LPXETMCEyj0bpkR74i2wAaOpsbGNsB8fvCZvOKapYYV3qDGc4Oat8vLo8tTW9QEv/frcOevyw1g5TJ3HuywXeyQ0=,iv:VnyWMkR45M3DeeVwhGfMGq1A1lO8cNnxf/4tMr7XJDw=,tag:ctUMVu2Z6pjhW0OstM5JkQ==,type:str]
    pgp:
        - created_at: "2022-10-18T07:21:03Z"
          enc: |
            -----BEGIN PGP MESSAGE-----

            hQIMAw/ulVIIwdPpAQ//dMQ8yhbWrtgx9STbNIva5mdhFigUiijuJre6SHRmiqbk
            98kFHjRlcBpRu52oKo6/cqmAO/DPBH+Gu2qR+9RCdZHC3DFN1Pc+MmE/NyYUlVg1
            wkcJxbisc1fWh1dp4rVD/DBJPAvmldvuKl0tjbJgHuhUIBwPp1dZXvmJzNQd8+OU
            jiL/DODf08C3szVZuj/PQcldfCVGZPKIYZTOPt+lEkiCNJ3Kh4GAvdlB0UwsmhPn
            QmwS1LD1eDBklkmRBzuOPxoxKRs1WDh4TxKnc5RBnaAb0IQqPu1vZ2dvMswayDCD
            H9pykD1zPQdU3wBQAkeQN+3BIBz4r4uLo8bqo8jQm1/TihmfOuFMAgHuSLaXGwNn
            5gfA4XvGSgUV3QSmeTMXjMjQnH273kNyAzYqtPWfnpZHHPXYdsQPG85o06838vlF
            1z2+YPa8nbKvgwjgAi7RRUwWZcWsCP5THO5Ec2YUfz6zu1Wy4FoLzr55O1Kd8p/h
            2KzzF/tKOgJOx16DSArHdcwhVgnmXgFq7YfvnOSF/7zuwFJ2qh9nzegn10kymPQi
            0sbB62wCpTun8hN2Sm/mA0V0KC+hWH3nv+Si0WXcMGkbuCmJSnFnoYnUxluOsh7a
            qvXDCkTN8I1DG+A3pFzEGbch/x4pxsS2H99FW//GfNhmJbwJb0Oa+4Q+B2wY64fS
            XgHzx5zsvFJjJht6VvjxTC+tXtggmMyvi5GgfmxCeeai2YAn/xrEvswXWOVMavds
            yzGJ2f3MMKqK4MNOJnNdvLXnT/v76XeUQ6isTy8fvZDczzRm2pLADA3lrCpYtgY=
            =SV/H
            -----END PGP MESSAGE-----
          fp: 951C4036C935A27E945AF64082E0A28289DDEC36
    encrypted_regex: ^(password|htpasswd|cert|key|apiUrl|caCert|secret|accessToken)$
    version: 3.7.3
