apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
    name: redis
    namespace: argocd
    # Finalizer that ensures that project is not deleted until it is not referenced by any application
    #  finalizers:
    #    - resources-finalizer.argocd.argoproj.io
#    annotations:
#    argocd.argoproj.io/refresh: hard
#        argocd.argoproj.io/sync-options: Validate=false
spec:
    project: default
    syncPolicy:
        automated:
            prune: true
            selfHeal: true
        syncOptions:
            - CreateNamespace=true
            #            - Validate=false
        retry:
            limit: 2
            backoff:
                duration: 2s
                factor: 2
                maxDuration: 1m
    source:
        chart: redis
        repoURL: https://charts.bitnami.com/bitnami
        targetRevision: 17.3.5
        helm:
            releaseName: redis
            #valueFiles: null
            #         - https://raw.githubusercontent.com/ifeneg/sops/main/app/redis.yaml
            #        - secrets+gpg-import-kubernetes://argocd/helm-secrets-private-keys#key.asc?https://raw.githubusercontent.com/ifeneg/sops/main/app/redis-enc.yaml
            #        - secrets+gpg-import:///helm-secrets-private-keys#key.asc?git+https://github.com/ifeneg/sops@app/redis-ha/secrets.yaml?ref=main"
            values:
                global:
                    redis:
                        password: ENC[AES256_GCM,data:bRLGj+mb0JE=,iv:KmKI9jdKHgjt2EdPmm8fNAMfBl9SJAe7pmWrGK4WMsU=,tag:NsXa9q5fEJzQEZYhvbfLgg==,type:int]
                architecture: standalone
                master:
                    kind: Deployment
                    persistence:
                        enabled: false
    destination:
        server: https://kubernetes.default.svc
        namespace: redis
sops:
    kms: []
    gcp_kms: []
    azure_kv: []
    hc_vault: []
    age: []
    lastmodified: "2022-10-18T07:48:12Z"
    mac: ENC[AES256_GCM,data:Y8vsZgBSi06LksN19wjf+w2MCr+1d2xF32MBclXVuZB4yjbgpMMprqAghNHRKQAHXobvh6nzSb2DrMv+Zhzc6JWm9YP4ZlBuoknFEeVC1i3iz2sqKdpIkUNM9rGvLFejQ3XYBt79jbz6xW+vDghLvqXlxWOPq1hJMfbQg6ZqYdc=,iv:DM2TMnCN8wmBXz2zAuD8WprWpAoGD6rtOJ+/58q1MPc=,tag:TovVYJ/Neq0y77Nfc4NH2g==,type:str]
    pgp:
        - created_at: "2022-10-18T07:48:11Z"
          enc: |
            -----BEGIN PGP MESSAGE-----

            hQIMAw/ulVIIwdPpAQ/+Iyvwuem1BejzCp7xtxcvjcdDFLcFzKQprrfCKCU3EJHF
            OZlZ3wpvD6qewLyeUQE+qaAGzSWADjPCv9mFM7F1kA8v7/XJg3BLzXElsu+Z+NT1
            6M9yPmue9vABmiwsrTkzrs6iEiOvWEYTW0bt8qdveZy64Xu5qYlO1PLrOpDZvwXN
            nOd6hSGHA88uX4JmfDckVeC9FLira2i0hmno9oxRx9QI8LjTjZ6+y3vmwBYf+k/t
            jDst9rV758kjO+LOqy7jB0uqp7RtqBn6lVFsvurPXQZpeDo79NEMq4UZv87g3GpK
            yLhejQyi5zUfRZ235vyU4dsuOJpTFI8bQM/6o4JDD1Hp18OeXlyzot7NC3cv+Bok
            oNyGSu74uBnvr3fOyRA0wjvodWBW15Pyn8wNARf1LjQy0JR1xTzPP0QuWZN5toI3
            sH343XvNGh5ByeqkWN2q5oB1QTS2JPhFaFqZIqVcKJHoLuQjW1j6tgKfqdibmh66
            BXwi8U+Kr9irxCTPjChplxYbx5wQkurGBr1jF3LObyPeKES2DThM6t3b70GrXuDP
            7f7xPr0qPaz41GfdoiGeGUycx+OXQ4WhT8mcshqXV59va3C3GsBo4yRDTRe1NqxQ
            2CpIMLKEkyX4iELuOq9xPNQdk/2cVCmwDsNwaYgw8NqImmyR0DDbjyEJ32QF9KLS
            XgHehEOBBP6vTvZPMU0itYOmzNgWrNkfDkZw2x8/LyApI2yDBMYmN/FGrlX23jwB
            gFY+gNmc+y13TXCZr8nU+f4+wyXl6vwGZ5IXZ7bjGfl+0UJ3By8yFJwPn5IlAwc=
            =Ecdf
            -----END PGP MESSAGE-----
          fp: 951C4036C935A27E945AF64082E0A28289DDEC36
    encrypted_regex: (password|htpasswd|cert|key|apiUrl|caCert|secret|accessToken)$
    version: 3.7.3
