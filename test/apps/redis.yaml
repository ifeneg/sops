apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
    name: redis
    namespace: argocd
    # Finalizer that ensures that project is not deleted until it is not referenced by any application
    #  finalizers:
    #    - resources-finalizer.argocd.argoproj.io
#    annotations:
#    argocd.argoproj.io/refresh: hard
#        argocd.argoproj.io/sync-options: Validate=false
spec:
    project: default
    syncPolicy:
        automated:
            prune: true
            selfHeal: true
        syncOptions:
            - CreateNamespace=true
            #            - Validate=false
        retry:
            limit: 2
            backoff:
                duration: 2s
                factor: 2
                maxDuration: 1m
    source:
        chart: redis
        repoURL: https://charts.bitnami.com/bitnami
        targetRevision: 17.3.5
        helm:
            releaseName: redis
            #valueFiles: null
            #         - https://raw.githubusercontent.com/ifeneg/sops/main/app/redis.yaml
            #        - secrets+gpg-import-kubernetes://argocd/helm-secrets-private-keys#key.asc?https://raw.githubusercontent.com/ifeneg/sops/main/app/redis-enc.yaml
            #        - secrets+gpg-import:///helm-secrets-private-keys#key.asc?git+https://github.com/ifeneg/sops@app/redis-ha/secrets.yaml?ref=main"
            values: ENC[AES256_GCM,data:K/SStmu4dUQk6OB2gE+qzL+0iSkUZUtgwQ6cOUtgSaGU9tHWRi7Mtv29vHJiAOkgQSCnmi7CHOwgeT4M4UaGiC/lkfcCp2G4EOkluRrt7zkopEdv2v5G57VxykVqBA+Pu1eWqoAEcToebJAbss+l8k6dwWjXGr8SsfFmkjFwvcySq1dw3h8EYttjYmM=,iv:/GxkCbgZmU5+eY62oYqBwsPI0oGS7DOT3zzzSupuQ30=,tag:VGmDdAQLWqRSoSdeBfKgWQ==,type:str]
    destination:
        server: https://kubernetes.default.svc
        namespace: redis
sops:
    kms: []
    gcp_kms: []
    azure_kv: []
    hc_vault: []
    age: []
    lastmodified: "2022-10-18T07:55:32Z"
    mac: ENC[AES256_GCM,data:IyYefe2UpIlYL8nrl8bSjuAMA79162Ezg6kWLOcD3vUCMdqWD46v5bck6Otq9x3nJ8kf5K1YQJIIH8Pj/6ArLENqJq0BCIC/JjMSWYgzjF+gCU2+ZSKx2oByvqlXjlEBeBiYZ7BOrCGJcOHtaL+6B6B0l+XYJeSgyO7MHUEuSYs=,iv:gbT3XBOf9tAncPOm6O3+T6PQ/3uTLYb9JDfMcyZ+tbA=,tag:TopYkZrNQPNzvdqzQ2lfVw==,type:str]
    pgp:
        - created_at: "2022-10-18T07:55:32Z"
          enc: |
            -----BEGIN PGP MESSAGE-----

            hQIMAw/ulVIIwdPpAQ/+PaKMnFIpkiB8XAF3bOsYXcf6NCIALHmTPvypaPraO9d1
            L8WTIbWXP4ROGcLZNMpSvA6VeDAB+legatU2CAwQUDHkyUlQeLR9XHXKJyXN/Mks
            aFD5w5vkfwEMPm2O0bQHrRhS56Eyql7exbXIifXCsnRCR8Id+J9UrKJzp+6HVSyZ
            cIvZ7LRCpZBSh/KUn2oYDYF0Xo28LwHVf1UGzYStLPq8b2hhtrv4mQoCmDJqvOAE
            5yeUCRxnRQBBKY1ybBkVCHhNQpZTpFdawKRRtEk4EHn9UmZLImHlOK31/eMHt7SM
            30xrt7HTer5IDR1rVtjyM2WU9eJIbT72J3jcJe258QurZTptS1rzePX2evWOEyDG
            tw5unPEjQuJjNShU0AZFqmtOK7B3pcA4uYstF+B4TKOMnNKaE0QWi9+yT9tulj4+
            DUS4+JLXwO9gxRx7vd/bKw2DUl2SswrPvh/mt29A02JUIjN1mh9e+TmA5m2fHB/C
            YZdN1cfyurJQ3YHkjIhmRssPBfaF6LvVmcqTe/VZe26qY94/5eC73SpVZEoesXVx
            wwWafn3TNB4ItddHS4CABCGVSkDd0lVtPyFAX9+veGhD2E0Ziaq+EctGsb4gWjfe
            1YDU8f+H1QfCP1jGwqbXMFJ/Wu7PxuHNruWi4/HbOLrRYh0Q+MND2Igy1HVAFY3S
            XgFuGXjzkfiUfWWGIGW5htiivA72RwpbOnSalQlZ7MjW6tqT+LtGejm1B/E0FUbL
            cAalOqdnR66t/0LyaUtPW4W3m/seGRfVz5ogTVplM7pv7g8huge6JBbWDnXIPVY=
            =GSU/
            -----END PGP MESSAGE-----
          fp: 951C4036C935A27E945AF64082E0A28289DDEC36
    encrypted_regex: (values)$
    version: 3.7.3
